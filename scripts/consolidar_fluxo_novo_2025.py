#!/usr/bin/env python3
"""
Consolida CSV Fluxo novo 2.025 - Remove linhas vazias, corrige encoding, valida dados
"""
import csv
import sys
from datetime import datetime

# Dados brutos do CSV
csv_content = """ID;Hora de in√≠cio;Hora da conclus√£o;Email;Nome;Nome completo da paciente;Data de nascimento da gestante;CARTEIRINHA (tem na guia que sai do sistema - n√£o inserir CPF);N√∫mero de Gesta√ß√µes;N√∫mero de Partos Ces√°reas;N√∫mero de Partos Normais;N√∫mero de Abortos;Informe dois telefones de contato com o paciente para que ele seja contato pelo hospital;Informe o procedimento(s) que ser√°(√£o) realizado(s);DUM;Data da DUM;Data do Primeiro USG;Numero de semanas no primeiro USG (inserir apenas o numero) - considerar o exame entre 8 e 12 semanas, embri√£o com BCF;Numero de dias no primeiro USG (inserir apenas o numero)- considerar o exame entre 8 e 12 semanas, embri√£o com BCF;USG mais recente (Inserir data, apresenta√ß√£o, PFE com percentil, ILA/MBV e doppler);Informe IG pretendida para o procedimento;Coluna3;Informe a indica√ß√£o do procedimento;Indique qual medica√ß√£o e dosagem que a paciente utiliza.;Indique os Diagn√≥sticos Obst√©tricos Maternos ATUAIS ( ex. DMG com/sem insulina, Pre-eclampsia, Hipertens√£o gestacional, TPP na gesta√ß√£o atual, RPMO na gesta√ß√£o atual, hipotireoidismo gestacional, etc);Placenta previa centro total com acretismo confirmado ou suspeito;Indique os Diagn√≥sticos Fetais (ex: RCF, Oligo/Polidramnio, Macrossomia, malforma√ß√£o fetal - especificar, cardiopatia fetal - especificar, etc);Informe Hist√≥ria Obst√©trica Pr√©via Relevante e Diagn√≥sticos cl√≠nicos cir√∫rgicos (ex. Aborto tardio, parto prematuro, √≥bito fetal, DMG, macrossomia, eclampsia, pr√© eclampsia precoce, cardiopatia - esp;Necessidade de reserva de UTI materna;Necessidade de reserva de Sangue;Maternidade que a paciente deseja;M√©dico respons√°vel pelo agendamento;E-mail da paciente;DPP DUM;DPP USG;Idade;DATA AGENDADA;Coluna2;Coluna22;Coluna1;Coluna12;Coluna13;Coluna14;IG IDEAL;Data Agendada2;IG na data;Intervalo (dias);Observa√ß√µes;Coluna26;IG_Atual_Dias;IG_Atual_Formatada;Metodo_IG;IG_Recomendada_Dias;IG_Recomendada_Formatada;Data_Ideal_Calculada;Data_Agendada;IG_na_Data_Agendada_Formatada;Intervalo;Status_Verificacao
2550;11/18/2025 15:07:50;11/18/2025 15:14:49;anonymous;;Dalila Pedro da Silva ;02/03/1987;1ar9LA000042005;1;0;0;0;11 988371894// 11 993487165;Indu√ß√£o Programada;Sim - Confiavel ;01/03/2025;22/05/2025;9;6;11/11 if 35 sem 5/7 cef peso 3003g p93 mbv4,2 pa(I) Doppler normal ;38;;DM II em uso insulina e descompensado com feto gog;Insulina NPh (36-22-20) , c√°lcio , AAS , megamather / Lt4 50 mcg;DM Ii em uso de insulina , descompensado /// indu√ß√£o agendada para Jundia√≠ , mas paciente deseja realizar em osasco ;N√£o;Feto GIG;Primigesta ;N√£o;N√£o;Cruzeiro;Bruna Mariano;dalilapedro96@gmail.com;06/12/2025;19/12/2025;38,76;agendada 02/12 37+4 pedir dx, ver nutri;Controle no grupo Wpp;Controle pessimo! de que mes √©? hj √© 24 e ja tem anotacao ate 29, precisa ajustar insulnina, passar p/ meninas do DM;Paciente foi encaminhada, podemos enviar a data do agendamento?;;;;;;;;;;238;34s 0d;USG;259;37s;2025-12-04;12/02/2025;;;Pendente
2505;11/14/2025 7:28:11;11/14/2025 7:34:18;anonymous;;Adriana Pinto  Pereira  Galdino ;07/05/1987;1ZEI004112016;1;0;0;0;11937681617/11965628435;Ces√°rea;Sim - Confiavel ;10/04/2025;31/05/2025;7;6;7/11 IG 30,1 plac ant I , gemelad MONO/DI dusc 8 % osso 1 1655 perc 50-90  feto 2 peso 1522 perc 50-90 v;36;;Gemelaridade mono/di;Vitaminas;Ndn;N√£o;Ndn;Ndn;N√£o;N√£o;Salvalus;Marisa Helena;Adriana.pp@outlook.com;15/01/2026;11/01/2026;38,58;agendada 11/12 35s - protoc mono/31 34-36sem;;;;;;;36s;;;;Maternidade Salvalus. IG ideal baseada em Gemelaridade mono/di.;;217;31s 0d;DUM;273;39s;2026-01-08;18/12/2025;36s0d;29;Verificado
2516;11/17/2025 8:45:21;11/17/2025 8:50:33;anonymous;;GIOVANNA VILAS BOAS BORELLI;28/11/1993;WP0M7000031003;3;2;0;0;11 91111-2676;Ces√°rea;Sim - Confiavel ;27/03/2025;29/05/2025;8;5;07/11/2025 - 32S2D / CEF / 2764G (P97) / MBV 5,5 / DOPPLER NORMAL / FETO GIG;37S0D ;;DMG COM REPERCUSS√ÉO FETAL (FETO GIG) / AL√âM DE MULTIPLAS COMORBIDADES;METILDOPA 500MG 8/8H / PURAN 75 MCG/DIA / REGENESIS PREMIUM / CALCIO;OBESIDADE G4 / ITERATIVIDADE / DMG / HAC ** sem uso de insulina por controle glicemico 100% normal;N√£o;FETO GIG;-;N√£o;N√£o;Salvalus;Wilson Loike;giovana.vb@yahoo.com;01/01/2026;03/01/2026;32,01;agendada 11/12 37s, ver nutri, grupo DM, pedir p/ medir 7xd;Encaminho Whats, solicitano controles. Enf¬™ Ana ;;;;;;40s;;;;Maternidade Salvalus. IG ideal baseada em DMG COM REPERCUSS√ÉO FETAL (FETO GIG) / AL√âM DE MULTIPLAS COMORBIDADES.;;224;32s 0d;USG;266;38s;2025-12-25;01/01/2026;40s0d;43;Verificado
2554;11/19/2025 9:30:47;11/19/2025 9:35:44;anonymous;;MILLENE SILVA SANTOS;19/08/2005; 1ZHV5000054011;1;0;0;0;11 941954778  //  11 952484116;Indu√ß√£o Programada;Sim - Confiavel ;17/03/2025;02/05/2025;6;5;17/11 - 35 SEM CEF 2570 P47 MBV 7,2 DOPPLER NL PBF 10/10;39/40;;DESEJO MATERNO;MATERNA / SF;DMG;N√£o;NDN;NDN;N√£o;N√£o;NotreCare;Raquel Grecco;MILLENESILSANTOS19@GMAIL.COM;22/12/2025;21/12/2025;20,28;17/12/2025;N√£o consta na agenda do Notrecare.;;;;;;39s;;;;Maternidade NotreCare. IG ideal baseada em DMG sem insulina.;;241;34s 3d;DUM;280;40s;2025-12-22;17/12/2025;39s0d;28;Verificado
2558;11/19/2025 11:13:55;11/19/2025 11:19:29;anonymous;;Claudia de Araujo Silva;26/04/1988;0M0YI002036002;2;1;0;0;11 977592187.   11 955588839;Ces√°rea + Laqueadura;Sim - Confiavel ;20/03/2025;29/05/2025;10;5;27/10 31 4/7 sem 1960 p64 ila nl dopler nl;37/38;;Desejo materno;Metildopa 750/d; levotiroxina 50; insulina NPH 6/4/0  Reg 2/2/0;HAC + Hipotireoidismo + DMG;N√£o;Ndn;Pre eclampsia e PC c/ 37 sem;N√£o;N√£o;NotreCare;Jamir Piquini;claudiaaraujosilva96@gmail.com;25/12/2025;20/12/2025;37,61;15/12/2025;ESTA NA PLANILHA DIA 02/12 (Duplicada);;;;;;38s;;;;Maternidade NotreCare. IG ideal baseada em DMG com insulina.;;238;34s 0d;DUM;280;40s;2025-12-25;15/12/2025;38s3d;26;Verificado
2560;11/19/2025 12:30:28;11/19/2025 12:40:48;anonymous;;Claudia de Ara√∫jo Silva;26/04/1988;0MOYI002036002;2;1;0;0;11 977592187.  11 995512386;Ces√°rea + Laqueadura;Incerta;;29/05/2025;10;5;27/10. 31 4/7 sem 1960 p64 ila nl dp nl;37/38 sem;;Desejo materno;Levotiroxina; insulina NPH 6/4/0  Reg 2/2/0; metildopa 750/d;HAC + Hipotireoidismo + DMG c/ insulina;N√£o;Ndn;Pre eclampsia na primeira gesta√ß√£o;N√£o;N√£o;NotreCare;Jamir Piquini;Claudiaaraujosilva96@gmail.com;06/10/1900;20/12/2025;37,61;12/02/2025;Duplicada;;;;;;38s;;;;Maternidade NotreCare. IG ideal baseada em DMG com insulina.;;238;34s 0d;USG;266;38s;2025-12-11;12/02/2025;38s0d;12;Verificado
2570;11/21/2025 7:15:22;11/21/2025 7:25:03;anonymous;;Driely J√∫lia Silva Gusm√£o ;01/12/1992;1PH26000001007;1;0;0;0;11982472622.  11991113526;Ces√°rea;Sim - Confiavel ;26/02/2025;16/04/2025;6;3;18/11 Ig 37 semana2 d peso 3428 g p97;39 semanas;;Gig;Vitaminas;Diabetes gestacional ;N√£o;Macrossomia;Dg;N√£o;N√£o;NotreCare;Renata Daura Lanzone;drielyjulia_01@hotmail.com;03/12/2025;07/12/2025;33,01;26/11/2025;NA agenda do notre DIA 26/12;;;;;;39s;;;;Maternidade NotreCare. IG ideal baseada em Gig.;;260;37s 1d;DUM;273;39s;2025-11-26;26/11/2025;39s0d;7;Verificado
2574;11/21/2025 10:15:07;11/21/2025 10:19:18;anonymous;;Tamires Teodoro ;03/03/1998;1ZUNX000885010;1;0;0;0;11989577248/ 1174693420;Ces√°rea;N√£o sabe;;01/06/2025;9;1;Usg 16/10 gemelar Didi feto 1 CEF BCF+, PFE 1135g, l√° 5,8plac post I/ Feto 2 p√©lvico BCF+ pfe 1120, m v 5,1cm, plac ant I, Doppler normal diferen√ßa de peso 1%;37-38 sem ;;Gemelar Didi ;-;Gemelar Didi ;N√£o;Gemelar Didi ;Gemelar Didi ;N√£o;N√£o;NotreCare;Fernanda Taniguchi Falleiros;tamires.teodoro0324@gmail.com;06/10/1900;03/01/2026;27,75;22/12/2025;;;;;;;38s;;;;Maternidade NotreCare. IG ideal baseada em Gemelar Didi .;;228;32s 4d;USG;273;39s;2025-12-28;22/12/2025;38s0d;32;Verificado
2575;11/21/2025 10:43:57;11/21/2025 10:47:35;anonymous;;Sandra da Silva Martins ;19/09/1987;1SRCQ000194000;4;0;0;3;11 980589124/ 11945387110;Ces√°rea;Sim - Confiavel ;28/03/2025;16/06/2025;11;5;19/11 - FUL p√©lvico BCF+, PFE 2488g p71, plac post I, Doppler normal MBV 4,9 Doppler normal ;39 sem ;;P√©lvico ;Enoxaparina 40mg/d ;Trombofilia + IMA ;N√£o;P√©lvico ;SAAAF / IMA ;N√£o;N√£o;NotreCare;Fernanda Taniguchi Falleiros;douglas.souza.f@hotmail.com;02/01/2026;31/12/2025;38,21;26/12/2025;;;;;;;39s;;;;Maternidade NotreCare. IG ideal baseada em P√©lvico .;;230;32s 6d;DUM;273;39s;2025-12-26;26/12/2025;39s0d;37;Verificado
2576;11/22/2025 9:25:33;11/22/2025 9:29:58;anonymous;;JANAINA NUNES DE ABREU;19/09/2004; NB5X8000012009;1;0;0;0;11963399427   11981765695;Ces√°rea;Incerta;;16/05/2025;10;1;10/11  IG 35SEM 1 DIA CEFALICO PESO 2924 G P67 DOPPLER NL;39;;DESEJO DA PACIENTE;VITAMINAS;DIABETES GESTACIONAL;N√£o;NDN;NDN;N√£o;N√£o;NotreCare;Renata Daura Lanzone;JANAABREU720@GMAIL.COM;06/10/1900;11/12/2025;21,20;;;;;;;;;;;;;;;;;;;;;;;;
2577;11/24/2025 8:36:54;11/24/2025 8:38:47;anonymous;;INGRID GONCALVES CAMPOS LIMA;21/10/1999; 1QB8R024734004;1;0;0;0;11932209794/11913740300;Ces√°rea;Sim - Confiavel ;13/03/2025;16/05/2024;8;4;17/11 CEF 2999G P90 MB NL DP NL;39;;DESEJO MATERNO;METILDOPA 750 MG/DIA;OBESIDADE GRAU 3 )PESO 126 KG) + HAC;N√£o;FETO GIG P90;NDN;N√£o;N√£o;Salvalus;Cilm√©rio Filho;ingridgoncalves2110@gmail.com;18/12/2025;22/12/2024;26,12;;;;;;;;;;;;;;;;;;;;;;;;
2578;11/24/2025 8:31:36;11/24/2025 9:09:00;anonymous;;GILMARA SAMPAIO FABELICIO;26/04/1988;3010T064847004;02;01;0;0;11 94211-6116 / ;Ces√°rea;Sim - Confiavel ;28/03/2025;22/05/2025;8;0;19/11/2025 - 33S5D / CEF / 1559G / P1 / MBV 4,5 / DOPPLER NORMAL;37s0d;;RESTRI√á√ÉO DE CRESCIMENTO FETAL PRECOCE / HIPERT GESTACIONAL;METILDOPA 750MG/D;HIPERT GESTACIONAL (PODE-SE CONSIDERAR PRE ECLAMPSIA TENDO EM VISTA RCF) /  SIFILIS TRATADA / IMA;N√£o;RESTRI√á√ÉO DE CRESCIMENTO FETAL PRECOCE - EM SEGUIMENTO DESDE 21 SEMANAS / TORCHS APRESENTOU HERPES POSITIVO - REALIZADO TTO ;--;N√£o;N√£o;Salvalus;Wilson Loike;gilmara.sanpao@gmail.com;02/01/2026;01/01/2026;37,61;;;;;;;;;;;;;;;;;;;;;;;;
2579;11/24/2025 10:26:25;11/24/2025 10:31:16;anonymous;;ALESSANDRA FRANCA DA SILVA;11/07/1990;0UIFP000001007;2;1;0;0;982698952;Ces√°rea;N√£o sabe;;18/06/2025;12;0;19/11/25 34 SEM 2305G P 41 - ILA E DOPPLER NORMAIS;38 SEM -;;ASMA GRAVE + DESEJO MATERNO;ALENIA 2 X DIA/ TAPAZOL 5 MG/ DIA METILDOPA 750 MG ;HAS/ DMG / HIPERTIREOIDISMO/ ASMA / ARTRITE REUMATOIDE;N√£o;-;HAS/ ARTRITE REUMATOIDE/ HIPERTIREOIDISMO / ASMA;N√£o;N√£o;NotreCare;Juliana Fazio;alessandrafranca11@gmail.com;06/10/1900;31/12/2025;35,40;;;;;;;;;;;;;;;;;;;;;;;;
2580;11/24/2025 11:38:09;11/24/2025 11:41:43;anonymous;;Ana Carolina dos Santos Silva Dias Acad;06/03/1995;3010T088529002;3;2;0;0;11 993865456;Ces√°rea;Sim - Confiavel ;25/03/2025;08/05/2025;5;5;18/11 - 34 semanas, 2352g (p43), mbv e doppler normais;39;;Iteratividade ;Metildopa 2g, anlodipino 5mg;Hipertens√£o cr√¥nica sem pre-eclampsia;N√£o;Nenhum;Ndn;N√£o;N√£o;Salvalus;Sandra Regina Gon√ßalves;anacarolina.diasacad@gmail.com;30/12/2025;03/01/2026;30,75;;;;;;;;;;;;;;;;;;;;;;;;
2581;11/24/2025 12:24:56;11/24/2025 12:28:48;anonymous;;Paloma Eduarda Batista Braga;26/03/2004;0X2GT000594032;1;0;P;0;11 944410245.   11 971121705;Ces√°rea;Incerta;;24/04/2025;6;1;19/11 36 sem 3191 p88 ila nl dp nl;37/38;;Desejo materno;Metildopa 2,0 gr/d;Hipertens√£o gestacional;N√£o;Ndn;Ndn;N√£o;N√£o;NotreCare;Jamir Piquini;paloma.eduardda@gmail.com;06/10/1900;17/12/2025;21,68;;;;;;;;;;;;;;;;;;;;;;;;
2582;11/24/2025 13:17:13;11/24/2025 13:23:53;anonymous;;Graziela Figueira Pinho ;29/10/1988;1SQH0000001007;5;0;4;1;11985656863;Indu√ß√£o Programada;Sim - Confiavel ;26/03/2025;19/05/2025;8;2;18/11 IG 34,3 doppler nl LA nl peso 2342 perc 29 plac lar E II;37/38;;H√° cro ica mas n√£o controlada. Aumento MTD hoje, DMG n√£o controlado. OE na √∫ltima gesta√ß√£o. ;MTD 500 6/6 HS. aas, calcio. ;DMG, HA CRONICA n√£o controlada, PE anterior;N√£o;Ndn;Pe em gesta√ß√£o anterio;N√£o;N√£o;Salvalus;Marisa Helena;Grazi.pires.0102@gmail.com;31/12/2025;27/12/2025;37,10;;;;;;;;;;;;;;;;;;;;;;;;
2583;11/24/2025 13:47:37;11/24/2025 13:50:10;anonymous;;JOYCE CRISTINNE RIBEIRO DA SILVA;10/03/1999;1SLZD000132004;2;1;0;0;11958029423/11981029317;Ces√°rea + Laqueadura;Sim - Confiavel ;25/03/2025;15/05/2025;7;1;19/11/2025 - PELVICO 2464G P 57 MB NL DP NL ;39;;FETO PELVICO;METILDOPA 1G/DIA + LEVOTIROXINA 50 MCG/DIA;HAC / OBESIDADE / HIPOTIREOIDISMO;N√£o;NDN;NDN;N√£o;N√£o;Salvalus;Cilm√©rio Filho;cristinnejoyce03@gmail.com;30/12/2025;31/12/2025;26,73;;;;;;;;;;;;;;;;;;;;;;;;
2584;11/24/2025 13:49:23;11/24/2025 13:55:14;anonymous;;THAIS SANTANA NASCIMENTO DOS SANTOS;02/11/1990;0XZQ0001485016;1;0;0;0;011 9 7973 3302;Ces√°rea;Sim - Confiavel ;14/03/2025;12/05/2025;8;0;24/11/25    FUVCEF PLA LADD G 2 LA  NL 2579  P20=36S3D;39;;DESEJO MATERNO;POLIVITA  LEVOID  50;HIPO T ;N√£o;NDN;HIPO T ;N√£o;N√£o;NotreCare;Lauro Massayuki Nakano;THAISTAMSANTOS08@YAHOO.COM;19/12/2025;22/12/2025;35,09;;;;;;;;;;;;;;;;;;;;;;;;
2585;11/24/2025 14:05:16;11/24/2025 14:10:17;anonymous;;Whitney Estevam Oliveira;16/08/1988;0Z6MR000001015;4;1;0;2;11 965247380;Ces√°rea;Sim - Confiavel ;03/04/2025;26/05/2025;7;2;10/11 - 31;2 semanas, pelvico, 2865g, mbv e doppler normais;38;;Cesarea anterior, hac sem pre-eclampsia, saaf em uso de enoxaparina;Enoxaparina 40mg, metildopa 1,5g;Saaf, hac;N√£o;Nenhum;Ndn;N√£o;N√£o;Salvalus;Sandra Regina Gon√ßalves;whitneyestevam@yahoo.com;08/01/2026;10/01/2026;37,30;;;;;;;;;;;;;;;;;;;;;;;;
2586;11/24/2025 14:34:24;11/24/2025 14:37:39;anonymous;;Luana Pereira dos Santos;16/09/1995;0MKMY001106007;1;0;0;0;11 942346926;Ces√°rea;Incerta;;30/04/2025;6;1;31/10 - 32;3 semanas, 2379g, mbv e doppler normais;39;;Desejo materno;Fluoxetina 20mg;Tad, fibromialgia;N√£o;Nenhum;Na;N√£o;N√£o;Cruzeiro;Sandra Regina Gon√ßalves;luana.psantos1816@gmail.com;06/10/1900;23/12/2025;30,21;;;;;;;;;;;;;;;;;;;;;;;;
2587;11/24/2025 15:03:06;11/24/2025 15:06:18;anonymous;;GEANE DIONISIO DOS SANTOS;16/08/1995;0ZBU1004470001;3;0;0;2;011 9 6223 0252;Cerclagem;Sim - Confiavel ;25/08/2025;11/10/2025;6;1;19/11  TN 11 ON+ DV NL.. 12S2D;13/ 14 S;;IIC;POLIVITA;NDN;N√£o;NDN;IIC;N√£o;N√£o;NotreCare;Lauro Massayuki Nakano;GEANEDIONIZIO29@GMAIL.COM;01/06/2026;05/06/2026;30,30;;;;;;;;;;;;;;;;;;;;;;;;
2588;11/24/2025 15:21:32;11/24/2025 15:25:35;anonymous;;Idineide Rodrigues de Souza;09/09/1983;1T68Q000103020;2;0;1;0;11 974362117;Ces√°rea + Laqueadura;Incerta;;09/05/2025;8;1;13/11 - 35 semanas, 2500g, mbv e doppler normais;39;;Apresenta√ß√£o p√©lvica ;Metildopa 1,5g;Hac sem pe;N√£o;Nenhum;Ndn;N√£o;N√£o;Cruzeiro;Sandra Regina Gon√ßalves;edineiderodriguesdesouza@gmail.com;06/10/1900;18/12/2025;42,24;;;;;;;;;;;;;;;;;;;;;;;;
2589;11/24/2025 17:19:40;11/24/2025 17:22:33;anonymous;;KATHERINE MARGARITA CUPARE GONZALEZ;17/12/1989; 1QBMX001131001;2;1;0;0;11963456238/11949274782;Ces√°rea;N√£o sabe;;03/07/2025;13;0;USG 12/11 CEF 2251G P 97 ILA NL DP NL ;39;;DESEJO MATERNO;METILDOPA 750 MG/DIA + AAS+ CACO3;HAC /  HIPOTIREOIDISMO;N√£o;FETO GIG;NDN;N√£o;N√£o;Cruzeiro;Cilm√©rio Filho;katherinecupare74@gmail.com;06/10/1900;08/01/2026;35,96;;;;;;;;;;;;;;;;;;;;;;;;
2590;11/24/2025 17:18:26;11/24/2025 17:23:29;anonymous;;PAOLA RODRIGUES DA SILVA ;08/04/1990;0YZ8D000036005;5;4;0;0;013 9 8848 8198     ///    011 9 6753 5890   ;Ces√°rea + Laqueadura;Incerta;;03/06/2025;10;5;23/11 FUVC PL POST G 3  LA NL. P 98 % =  3425 G =  DOPLER NORMAL  35S3D  ( BIOM 38S1D);38;;CESAREA ITERATIVA +  TVP ANTERIOR;CLEXANE 60   AAS  CACO. DAMATER;TVP GESTA√á√ÉO ANTERIOR ;N√£o;MACROSSOMIA;NDN;N√£o;N√£o;NotreCare;Lauro Massayuki Nakano;PAOLARODRIGUES3625@GMAIL.COM;06/10/1900;25/12/2025;35,66;;;;;;;;;;;;;;;;;;;;;;;;
2591;11/25/2025 7:45:38;11/25/2025 7:55:51;anonymous;;TIARA ALMEIDA DE SOUZA;01/11/2025;1TJEQ000001015;3;1;0;1;11949984959   11954708686;Ces√°rea;Sim - Confiavel ;15/03/2025;09/05/2025;7 6/7;56;18/11/25CEFAICO PWSO 2776 %58 MBV 5,3 DOPPLER NL;3;;2A CESAREA  ULTIMA 1 ANO E  MES PRE ECLAMPSIA COM 39 SEMANAS;VITAMINAS;NESTE NADA;N√£o;NAO;ABORTO 2019APOS GESTACAO COM PREECLAMPSIA 39 SEMANAS;N√£o;N√£o;NotreCare;Wagner Perruolo;TIGUILGER.RM@GMAIL.COM;20/12/2025;25/10/2025;0,07;;;;;;;;;;;;;;;;;;;;;;;;
2592;11/25/2025 8:29:41;11/25/2025 8:37:29;anonymous;;Michele Santos da Silva ;04/05/1992;0n06d001030027;4;0;3;0;986228769;Indu√ß√£o Programada;Laqueadura  P√≥s-parto Normal;Sim - Confiavel ;17/03/2025;28/05/2025;11;0;24/11 fuvlc 36 5/7 2940g (p66) mbv 9,3 c√° p90 Doppler nl;38;;Dmg;Insulina nph 12/12/16 regular 4/6/2);Dmg com insulina ;N√£o;Polidramnio ca p90;Hipotireoidismo Ltx 88;N√£o;N√£o;Cruzeiro;Paula Iervolino;Michelegabrielmayara@gmail.com;22/12/2025;17/12/2025;33,58;;;;;;;;;;;;;;;;;;;;;;;;
2593;11/25/2025 9:09:02;11/25/2025 9:11:25;anonymous;;ANA CAROLINA DA SILVA;14/02/2001;0RVW1000001031;2;0;0;1;11983801738   11984642309;Ces√°rea;Incerta;;10/06/2025;12;5;05/11/2025: cefalico, ILA 15,9cm, MBV 7,8cm, placentra posterior g1/2, peso 2561g p82, doppler normal;39;;desejo materno;-;DMG sem insulina;N√£o;-;-;N√£o;N√£o;Salvalus;Thiago Ricci;ancarolinaa.2021@icloud.com;06/10/1900;18/12/2025;24,79;;;;;;;;;;;;;;;;;;;;;;;;
2594;11/25/2025 9:06:51;11/25/2025 9:14:49;anonymous;;Juliana Ferreira de Melo;17/05/1983;0ZVUL0000001007;3;2;0;0;11 945347670.   11 982747176;Ces√°rea;Sim - Confiavel ;16/03/2025;28/04/2025;6;3;18.11- cef√°lica, 352/7 sem, 2820 g P58 mbv- 4,5 Doppler nl perfil 8/8;39/40;;Iterativa, ;Ndn;Dmg;N√£o;Ndn;Ndn;N√£o;N√£o;Salvalus;Ang√©lica do Ros√°rio;juferreira170583@gmail.com;21/12/2025;19/12/2025;42,56;;;;;;;;;;;;;;;;;;;;;;;;
2595;11/25/2025 9:22:05;11/25/2025 9:24:22;anonymous;;NATHALIA PEREIRA LIMA;07/07/2000;3010T041676033;1;0;0;0;11948300560   11948794967;Ces√°rea;Sim - Confiavel ;09/03/2025;17/05/2025;9;4;24/11/2025: cefalico, MBV 3,5cm, placenta anterior g3, peso 2524g p8,5, doppler nromal, PBF 10;39;;desejo materno;-;feto PIG;N√£o;feto PIG;-;N√£o;N√£o;Guarulhos;Thiago Ricci;nnathalianpl130@gmail.com;14/12/2025;16/12/2025;25,40;;;;;;;;;;;;;;;;;;;;;;;;
2596;11/25/2025 9:23:10;11/25/2025 9:26:37;anonymous;;Sandy Freitas de Jesus ;05/04/1998;0p5qk002044005;2;1;0;0;996566813 / 974913844;Ces√°rea + Laqueadura;Incerta;;07/05/2025;9;0;18/11 fuvlc 36 2/7 3344 (p89) c√° >p99 ila e Doppler nl;39;;Desejo;Puran 50;Pr√© natal incompleto ;N√£o;C√° acima p99;Hipotireoidismo ;N√£o;N√£o;NotreCare;Paula Iervolino;freitassandy59@gmail.com;06/10/1900;10/12/2025;27,66;;;;;;;;;;;;;;;;;;;;;;;;
2597;11/25/2025 9:54:01;11/25/2025 10:01:21;anonymous;;Stefane Aparecida Rebelo;02/02/1989;0ZBU1032842007;1;0;0;0;11 985872241.   11 963547649;Ces√°rea;Incerta;;20/06/2025;12;1;11.11- cef, 325/7 sem, 2144-P56 mbv-5,2 Doppler nl perfil 10/10;39/40 sem;;Desejo materno;Clexane  40 mg/dia metik dopa  250 6/6 h;Hipertens√£o gestacional , trombofilia;N√£o;Ndn;Primigesta;N√£o;N√£o;NotreCare;Ang√©lica do Ros√°rio;stefane_aparecida@yahoo.com;06/10/1900;01/01/2026;36,84;;;;;;;;;;;;;;;;;;;;;;;;
2598;11/25/2025 10:09:14;11/25/2025 10:12:43;anonymous;;Jessica Souza Garcia Barros ;01/10/1987;1NQ4E000158003;3;0;2;0;1197682-1821 / 1194004-3565;Ces√°rea + Laqueadura;Sim - Confiavel ;03/04/2025;17/05/2025;6;1;19/11: cef, bcf+, 2270g, plac ant grau 1, ila normal, Doppler normal. 32+5;39 sem ;;Desejo materno ;Nega ;Nega ;N√£o;Nega ;Nega ;N√£o;N√£o;Guarulhos;Gabriela de Miranda Cuba Nogueira;garcia_jessica0110@icloud.com;08/01/2026;09/01/2026;38,18;;;;;;;;;;;;;;;;;;;;;;;;
2599;11/25/2025 10:20:52;11/25/2025 10:31:22;anonymous;;Andressa Fernanda Clara Francisco ;02/08/1989;0W7EX002394006;3;2;0;0;11 953919865// 11 947781652;Ces√°rea;Sim - Confiavel ;19/03/2025;22/05/2025;9;4;19/11 ig 35 sem p√©lvico peso 2985g p88 C√° p>90 mbv8,6 Doppler fetal normal ;38;;Apresenta√ß√£o p√©lvica / dmg com polidramnio e peso fetal p99 ;AAS 100 mg/ c√°lcio 1g /ogestam gold;DMG/ polidr√¢mnio / peso fetal p88 e C√° p>90;N√£o;Polidramnio , feto Gig, apresentacao p√©lvica ;2 parto normais por indu√ß√£o tp com 41 sem;N√£o;N√£o;Salvalus;Bruna Mariano;andressafernandaclara67@gmail.com;24/12/2025;21/12/2025;36,34;;;;;;;;;;;;;;;;;;;;;;;;
2600;11/25/2025 10:31:49;11/25/2025 10:35:14;anonymous;;Ana Lucia Matos Santos;04/07/1997;DUDSY000091006;2;0;0;1;11 984203248;Indu√ß√£o Programada;Incerta;;02/07/2025;16;2;01/10- 29;6 semanas, 1570g, mbv e doppler normais;40;;Desejo materno, dmg (dieta);Propiluracil 300mg;Hipertiroidismo, dmg dieta;N√£o;Nenhum;Na;N√£o;N√£o;Cruzeiro;Sandra Regina Gon√ßalves;matosanalucia.00@gmail.com;06/10/1900;15/12/2025;28,41;;;;;;;;;;;;;;;;;;;;;;;;
2601;11/25/2025 10:53:24;11/25/2025 10:59:18;anonymous;;Carolina Rodrigues de Oliveira ;08/12/1988;0N1CJ001585002;3;2;0;0;11 994960646// 11 945366291;Ces√°rea + Laqueadura;Sim - Confiavel ;24/03/2025;26/06/2025;14;1;07/11 ig 32 s 4/7 cef peso 2031g p53 Ila 120 Doppler normal ;39;;Itwratividade/ planejamento familia;Sulfato ferroso , c√°lcio 1g , feminis ;HTLV reagente / iteratividade;N√£o;Sem diagn√≥stico ;1¬™ cesarea por sofrimento fetal / 2¬™ desejo materno / sem intercorr√™ncia gesta√ß√µes ;N√£o;N√£o;Cruzeiro;Bruna Mariano;lucasarcanjo.vera1106@gmail.com;29/12/2025;24/12/2025;36,99;;;;;;;;;;;;;;;;;;;;;;;;
2602;11/25/2025 10:55:56;11/25/2025 10:59:44;anonymous;;YNDAIA APARECIDA VALADARES DE MATOS;12/06/1999; 0W6HG000001007;2;01;0;0;11948075248 Indaia - 11987588991 Ismael;Ces√°rea;N√£o sabe;;10/06/2025;10;1;23/11 FUV, 33 semanas, p2591(p75), MBV 3,9 doppler normal;37 semanas;;DMG com insulina + DHEG;INsulina NPH 18/15/16 e metildopa 1g/dia;DMG e hipertensao gestacional;N√£o;ndn;histortia de pre eclampsia;N√£o;N√£o;Salvalus;Alyk Vargas;yndaia.vala@gmail.com;06/10/1900;05/01/2026;26,47;;;;;;;;;;;;;;;;;;;;;;;;
2603;11/25/2025 11:45:57;11/25/2025 11:49:05;anonymous;;Mara gutierres Santos ;13/12/1985;0z3ny000001007;1;0;0;0;988238685;Ces√°rea;Sim - Confiavel ;20/03/2025;05/05/2025;7;2;10/11/25 fuv, p√©lvico 2167g (p34) ila e Doppler nl;39;;Ap p√©lvica ;Nao;Ap p√©lvica ;N√£o;Nao;Ansiedade ;N√£o;N√£o;NotreCare;Paula Iervolino;maragutierressantos@gmail.com;25/12/2025;20/12/2025;39,98;;;;;;;;;;;;;;;;;;;;;;;;
2604;11/25/2025 13:05:30;11/25/2025 13:09:02;anonymous;;JAMILE DOS SANTOS SOARES;19/06/2001;0WRZX057643024;2;1;0;0;11 980980049, 11 993153875;Ces√°rea + Laqueadura;Incerta;;27/05/2025;11;1;13/11 cef 35 3/7 2962g p78  ca p>90, mb 3,9 doppler normal;38-39;;DESEJO MATERNO;VITAMINAS;DMG;N√£o;FETO COM CA P>90;NDN;N√£o;N√£o;Salvalus;Luana Gallo;jamiledossantos868@gmail.com;06/10/1900;15/12/2025;24,45;;;;;;;;;;;;;;;;;;;;;;;;
2605;MANUAL;;;;;;COSMERIA RIBEIRO DE SANTANA;29/02/1988;0NILI000588032;1;0;0;0;11 993643706;Ces√°rea;Sim - Confiavel ;19/03/2025;23/05/2025;9;0;FALTA USG RECENTE;;;;VITAMINAS/ CALCIO 500MG/ LEVOTIROXINA 50MG/ SOMANGIN 81MG;DMG dieta - restri√ß√£o de crescimento - defeito do septo atrioventricular forma total desbalanceado.;;FALTA DIAGNOSTICOS FETAIS;FALTA HISTORIA OBSTETRICA;N√£o;N√£o;Salvalus;MANUAL;cosmeliarsantana95@gmail.com;24/12/2025;26/12/2025;37,76;COMPLETAR DADOS MANUALMENTE;caso no grupo Wpp;;;;;;;;;;;;;;;;;;;;;;"""

print("üîÑ CONSOLIDANDO CSV FLUXO NOVO 2.025")
print("="*80)

# Parse CSV
lines = csv_content.strip().split('\n')
reader = csv.DictReader(lines, delimiter=';')

registros_validos = []
problemas = []

for row in reader:
    id_val = row.get('ID', '').strip()
    
    # Valida ID
    if not id_val or id_val == '':
        continue
        
    # Valida√ß√µes
    nome = row.get('Nome completo da paciente', '').strip()
    if not nome:
        problemas.append(f"ID {id_val}: Sem nome de paciente")
        continue
    
    carteirinha = row.get('CARTEIRINHA (tem na guia que sai do sistema - n√£o inserir CPF)', '').strip()
    if not carteirinha:
        problemas.append(f"ID {id_val} ({nome}): Sem carteirinha")
    
    maternidade = row.get('Maternidade que a paciente deseja', '').strip()
    if not maternidade:
        problemas.append(f"ID {id_val} ({nome}): Sem maternidade")
    
    registros_validos.append(row)

print(f"‚úÖ Registros v√°lidos: {len(registros_validos)}")
print(f"‚ö†Ô∏è  Problemas encontrados: {len(problemas)}")

if problemas:
    print("\nüî¥ PROBLEMAS DETECTADOS:")
    for p in problemas[:10]:
        print(f"  - {p}")

# Salva CSV consolidado
output_path = '/workspaces/gestaforms-hub/public/csv-temp/fluxo_novo_2025_CONSOLIDADO.csv'

# Define fieldnames do header (primeira linha do CSV original)
lines = csv_content.strip().split('\n')
header_line = lines[0]
fieldnames = [f.strip() for f in header_line.split(';')]

with open(output_path, 'w', encoding='utf-8', newline='') as f:
    if registros_validos:
        writer = csv.DictWriter(f, fieldnames=fieldnames, delimiter=';', extrasaction='ignore')
        writer.writeheader()
        writer.writerows(registros_validos)

print(f"\nüíæ Arquivo consolidado salvo: {output_path}")
print(f"üìä Total de linhas: {len(registros_validos) + 1} (header + dados)")
